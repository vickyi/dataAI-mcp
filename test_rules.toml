# 测试规则配置文件 - 启用所有规则

[general]
# 通用配置
sql_dialect = "hive"
enabled = true

[rules.select_star]
# 禁止使用 SELECT *
id = "R001"
enabled = true
level = "error"
description = "禁止使用 SELECT *，请明确列出所需字段"
message = "禁止使用 SELECT *，请明确列出所需字段"
exclude_functions = ["COUNT"]

[rules.partition_filter]
# 检查分区字段过滤
id = "R101"
enabled = true
level = "error"
description = "查询必须包含分区字段过滤条件，以避免全表扫描"
partition_fields = ["dt", "date"]
require_where_clause = true

[rules.table_alias]
# 检查表别名
id = "R002"
enabled = true
level = "warning"
description = "建议为表使用别名"

[rules.sensitive_columns]
# 检查敏感字段
id = "R301"
enabled = true
level = "error"
description = "查询中包含敏感字段，请确认是否有权限访问并已进行脱敏处理"
sensitive_keywords = [
    "phone",
    "email",
    "id_card",
    "password",
    "credit_card"
]

[rules.field_alias_naming]
# 检查字段别名命名规范
id = "R201"
enabled = true
level = "warning"
description = "字段别名建议使用下划线命名法"
naming_pattern = "^[a-z]+(_[a-z]+)*$"
invalid_patterns = ["^[a-z]+[A-Z][a-z]*"]

[rules.join_conditions]
# 检查JOIN条件
id = "R401"
enabled = true  # 启用此规则
level = "warning"
description = "JOIN语句应该包含明确的连接条件，避免笛卡尔积"

[rules.query_complexity]
# 查询复杂度检查
id = "R501"
enabled = true  # 启用此规则
level = "warning"
description = "查询复杂度过高，建议简化"
max_joins = 5
max_subqueries = 3
max_tables = 10